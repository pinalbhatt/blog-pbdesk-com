<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Razor support in Umbraco 4.7</title>
  <meta name="description" content="With Umbraco 4.6.1 in Jan,2011, they brought in one of the great feature to Umbraco CMS - Razor. And with Umbraco 4.7 in March, 2011 they have matured the ma...">

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-hQpvDQiCJaD2H465dQfA717v7lu5qHWtDbWNPvaTJ0ID5xnPUlVXnKzq7b8YUkbN" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/mdb.min.css">
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://blog.pbdesk.com/asp.net/cms/razor-support-in-umbraco-4-7">
  <link rel="alternate" type="application/rss+xml" title="Pinal Bhatt's Blog" href="http://blog.pbdesk.com/feed.xml">
</head>


<body>

<nav class="navbar navbar-fixed-top z-depth-2 danger-color-dark" role="navigation">
  <div class="container ">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand navbar-brand-ttl waves-effect waves-light" href="/">Pinal Bhatt's Blog</a>
    </div>

    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><a href="#products" class="waves-effect waves-light">Products <span class="sr-only">(current)</span></a>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle waves-effect waves-light" data-toggle="dropdown" role="button" aria-expanded="false">List (click to expand) <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="http://mdbootstrap.com/product/magic-portfolio-for-video-maker/">Video Maker</a>
            </li>
            <li><a href="http://mdbootstrap.com/material-design-for-bootstrap/">Material Design for Bootstrap</a>
            </li>
            <li><a href="http://mdbootstrap.com/product/magic-portfolio-for-creative-agency">Creative Agency</a>
            </li>
            <li><a href="http://mdbootstrap.com/product/magic-portfolio-photographer">Photographer Portfolio</a>
            </li>
            <li class="divider"></li>
            <li><a href="#footer">Footer</a>
            </li>
          </ul>
        </li>
      </ul>
      <form class="navbar-form navbar-right waves-effect waves-light" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
      </form>

    </div>
  </div>
</nav>


<div class="container">
  <h2 class="page-header h2-responsive">
    Razor support in Umbraco 4.7
</h2>

<div class="row">
  <div class="col-md-8">
    <article  itemscope itemtype="http://schema.org/BlogPosting">

      <header class="post-header">
        <h1 class="post-title" itemprop="name headline" style="display: none">Razor support in Umbraco 4.7</h1>
        <p class="post-meta">
          <time datetime="2011-03-07T11:49:00-05:00" itemprop="datePublished">Mar 7, 2011</time>
           • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">{"login"=>"pbadmin", "email"=>"pinalbhatt@gmail.com", "display_name"=>"PBDesk Admin", "first_name"=>"Pinal", "last_name"=>"Bhatt"}</span></span>
          <span class="pull-right"><a href="#" ><i class="fa fa-bookmark"></i> Asp.Net</a></span>
        </p>
        <hr/>
      </header>

      <div class="post-content" itemprop="articleBody">
        <p align="justify">With Umbraco 4.6.1 in Jan,2011, they brought in one of the great feature to Umbraco CMS - <strong>Razor</strong>. And with Umbraco 4.7 in March, 2011 they have matured the made it more usable, reliable and stable. </p>
<p align="justify">Razor is the view engine introduced by Microsoft team with ASP.Net MVC 3.0. It is optimized around HTML generation using a code-focused templating approach. And now Umbraco 4.7 provides excellent support for writing Razor scripts to create macros in umbraco. For those guys, including me, who dislike XSLTs, this is a great alternate for them.&#160; Now we can write the logic in C# or VB rather then in XSLT. Thanks Umbraco Team!!!. </p>
<p align="justify">In one of my pervious <a href="http://blog.pbdesk.com/2011/01/razor-support-in-umbraco.html">post</a>, I mentioned about using Razor scripts in Umbraco 4.6.1. You can consider this as an extension to that. In this post I have tried to describe what has changed from 4.6.1 to 4.7 and how to use Razors in Umbraco 4.7. </p>
<h2>Upgrading from 4.6.1 to 4.7</h2>
<p> 
<p><em>(Please note that 4.7 requires .Net Frameowork 4.0)</em></p>
<ol>
<li>Copy following folders from 4.7RC download: /bin, /umbraco and /umbraco_client. </li>
<li>Take care of web.config changes: Mainly there are 4 changes and they're clearly marked in the web.config in 4.7 as &lt;!-- Added in Umbraco 4.6.2 –&gt;. </li>
<li>Delete following .dll files from old installation under /bin folder      <br /><em>IronPython.dll          <br />IronPython.Modules.dll           <br />IronRuby.dll           <br />IronRuby.Libraries.dll           <br />IronRuby.Libraries.Yaml.dll           <br />Microsoft.Dynamic.dll           <br />Microsoft.Scripting.dll           <br />Microsoft.Scripting.Debugging.dll           <br /></em>Also delete following files if they exist. (in case if you have 4.7 beta)       <br /><em>RazorEngine.Core.dll          <br />RazorEngine.Templates.dll           <br />umbraco.MacroEngines.Legacy.dll           <br /></em></li>
<li>In 4.6.1, by default Razor scripts were saved in ~/python folder, where as in 4.7 default folder has changed to <strong>~/macroScripts</strong>. So if you have any .razor files under ~/python, you need to <u>move them to ~/macroScripts folder.</u> </li>
</ol>
<p>For general upgrade information follow the guide found at <a href="http://our.umbraco.org/wiki/install-and-setup/upgrading-an-umbraco-installation" target="_blank">http://our.umbraco.org/wiki/install-and-setup/upgrading-an-umbraco-installation</a>     <br />And here is one important thread from Umbraco Installation Forum which might be helpful: <a href="http://our.umbraco.org/forum/getting-started/installing-umbraco/17890-XSLT-macros-not-getting-rendered-after-upgrading-to-47-RC" target="_blank">http://our.umbraco.org/forum/getting-started/installing-umbraco/17890-XSLT-macros-not-getting-rendered-after-upgrading-to-47-RC</a></p>
<li>
<h2>Changes in Umbraco 4.7 </h2>
<ol>
<li>As mentioned above, now with 4.7 all razor scripts are to be saved in <strong>~/macroScripts</strong> folder. </li>
<li>Now the new razor script files will have extension of .cshtml or .vbhtml. In 4.6.1 razor script files were having .razor extension and only C# was supported. <u>Old .razor files will still work in 4.7</u> as far as they are in ~/macroScripts. But now new script files created will have extension .cshtml (for C#) and .vbhtml (for VB) </li>
<li>Now you cannot use single-statement in control-flow statements without&#160; {} block. ie. Any thing under control flow statements like if, for, while, foreach need to be in between&#160;&#160; {}&#160; block.&#160; For example, the following <u>is not</u> allowed: </li>
</ol>
<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px">
<div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px">
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px">@<span style="color: #0000ff">if</span>(isLoggedIn) </pre>
<p><!--CRLF--></p>
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px">Hello, @user </pre>
<p><!--CRLF--></div>
</p></div>
<blockquote>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Instead, wrap the contents of the block in &quot;{}&quot;: </p>
</blockquote>
<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px">
<div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px">
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px">@<span style="color: #0000ff">if</span>(isLoggedIn) { </pre>
<p><!--CRLF--></p>
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px">Hello, @user</pre>
<p><!--CRLF--></p>
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px">} </pre>
<p><!--CRLF--></div>
</p></div>
<h2>New Features in Umbraco 4.7 </h2>
<ol>
<li>
<div align="justify">One of the Major new feature in 4.7 is support for Macro Parameters in razor scripts. Yes now razor script can read parameters passed by macros using <strong>@Parameter.nameOfParameter</strong> syntax. </p>
<p></div>
</li>
<li>
<div align="justify">For proper randering, document type properties with html contents in them needs to be wrapped in Html.Raw() ie. @Html.Raw(Model.bodyText). Leaving this wrapper off will cause HTML to be encoded and render to the screen.<br />
        </div>
</li>
<li>
<div align="justify">IronPython and IronRuby is now not a part of the distribution and needs to be installed by unzipping the contents of the separate macroengine download. So if you are not using these Iron* scripts, you can remove ~/python folder.<br />
        </div>
</li>
<li>
<div align="justify">For technical changes (Programmers perspective) please refer to the serise of blogs at umbraco.com: </div>
</li>
</ol>
<ul>
    </ul>
<ul>
<li><a href="http://umbraco.com/follow-us/blog-archive/2011/2/23/umbraco-47-razor-feature-walkthrough-%E2%80%93-part-1" target="_blank">Umbraco 4.7 Razor Feature Walkthrough – Part 1</a> </li>
<li><a href="http://umbraco.com/follow-us/blog-archive/2011/2/24/umbraco-47-razor-feature-walkthrough-%E2%80%93-part-2" target="_blank">Umbraco 4.7 Razor Feature Walkthrough – Part 2</a> </li>
<li><a href="http://umbraco.com/follow-us/blog-archive/2011/2/28/umbraco-razor-feature-walkthrough-%E2%80%93-part-3" target="_blank">Umbraco Razor Feature Walkthrough – Part 3</a> </li>
<li><a href="http://umbraco.com/follow-us/blog-archive/2011/3/1/umbraco-razor-feature-walkthrough-%E2%80%93-part-4" target="_blank">Umbraco Razor Feature Walkthrough – Part 4</a> </li>
</ul></p>
</li>

      </div>

    </article>
    <div class="row">
      
      <div id="disqus_thread"></div>
      <script>
        /**
         * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
         * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
         */
        /*
         var disqus_config = function () {
         this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
         this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
         };
         */
        (function() { // DON'T EDIT BELOW THIS LINE
          var d = document, s = d.createElement('script');

          s.src = '//pbdesk-blog.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
      
    </div>
  </div>
  <div class="col-md-4">
    <div style="padding-left: 25px">
      <!-- PBDeskIOBlog-180x150 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:180px;height:150px"
     data-ad-client="ca-pub-4686631795727964"
     data-ad-slot="2637631941"></ins>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>
    </div>
    <h4>Quick Links</h4>
<div class="collection">
    <a href="/all-posts" class="collection-item">All Posts</a>
    <a href="/categories" class="collection-item">By Category</a>
    <a href="/tag" class="collection-item">By Tag</a>
    <a href="http://www.PBDesk.com" target="_blank" class="collection-item">PBDesk.com</a>
</div>
  </div>
</div>


  <div class="row">
    <!-- PBDeskIO-Responsive2 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-4686631795727964"
     data-ad-slot="2916833545"
     data-ad-format="auto"></ins>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>
  </div>
</div>


<footer class="page-footer danger-color" if="footer">
  <div class="container">
    <div class="row">
      <div class="col-md-3 col-md-offset-1">
        <p class="white-text center-on-small-only btxt">|| Learn ||<br/><em>Blended Learning Pathway</em></p>
        <p class="white-text center-on-small-only">Register for free and start to learn cutting edge technologies.</p>


      </div>
      <hr class="hidden-lg hidden-md">

      <div class="col-md-2">
        <p class="white-text center-on-small-only btxt">Links</p>
        <ul>
          <li><a href="#"  class="grey-text text-lighten-3" >Home</a>
          </li>
          <li><a class="grey-text text-lighten-3" href="#" target="_blank">About</a>
          </li>
          <li><a class="grey-text text-lighten-3" href="" target="_blank">Contact</a>
          </li>
          <li><a class="grey-text text-lighten-3" href="" target="_blank">Disclaimer</a>
          </li>


        </ul>
      </div>
      <hr class="hidden-lg hidden-md">

      <div class="col-md-4 text-center">
        <p class="white-text text-center">
          Concept perceived, designed & developed by <br/> Pinal Bhatt
        </p>
        <p class="white-text text-center btxt">follow me</p>
        <a target="_blank" href="https://www.facebook.com/mdbootstrap" class="btn-floating  fb-bg waves-effect waves-light"><i class="fa fa-facebook"> </i></a>
        <a target="_blank" href="https://twitter.com/MDBootstrap" class="btn-floating  tw-bg waves-effect waves-light"><i class="fa fa-twitter"> </i></a>
        <a target="_blank" href="https://plus.google.com/u/0/b/107863090883699620484/107863090883699620484/posts" class="btn-floating  gplus-bg waves-effect waves-light"><i class="fa fa-google-plus"> </i></a>
        <a target="_blank" href="https://twitter.com/MDBootstrap" class="btn-floating  tw-bg waves-effect waves-light"><i class="fa fa-twitter"> </i></a>
        <a target="_blank" href="https://twitter.com/MDBootstrap" class="btn-floating  tw-bg waves-effect waves-light"><i class="fa fa-twitter"> </i></a>
      </div>
    </div>
  </div>
  <div class="footer-copyright">
    <div class="container">
      <div class="col-md-10 col-md-offset-1">
        &copy;    <a href="http://www.PBDesk.com" target="_blank">PBDesk.com </a> - from the desk of Pinal Bhatt
      </div>
    </div>
  </div>
</footer>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
<script src="/assets/js/mdb.min.js"></script>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-9753249-7', 'auto');
    ga('send', 'pageview');
</script>
</body>

</html>
